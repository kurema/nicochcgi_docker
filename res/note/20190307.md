# 20190307
## チャンネル動画に配信の暗号化
[【3/6追記】3月5日より一部のチャンネル動画に配信の暗号化を有効にする対応を行います](https://blog.nicovideo.jp/niconews/100724.html)とのアナウンス。
実際に一部の動画がgetflvから取れなくなってる。
勘弁してくれ。

まぁこういうツールがあるからして当然といえば当然な気がするが、
どうせ540p程度の画質しか配信されないんだから気にするほどでもなかろうに。

MPEG-DASHってやつですかね。
こういう事になるならそりゃMozillaも反対するわけだ。
と言っても誰でも見れる動画なんだから、普通にgetflvと同じ感覚で鍵の取得はできそうだが、Perlではきつそうだな。
変換はffmpegでも呼べばできそうな気がするが。

実装も秘匿できるわけないのに(難読化(仮)されてるが)、保護になるのかね。
…実際はこの通りなってるけど。
いや確かブラウザの鍵を知らないと見れないとかいうやつか？

その関係で対象の動画?(過去動画)のコメントも取得できなくなってるようだ。
元々、見られない動画のコメントが取得できるのがおかしかったわけだしキャッシュでもしておくべきだったか。

現時点で実際対象動画は一部のみのようだが、困る。
最近、このサーバーにそこそこ入れ込んでいたけど意味なくなるかな。
せめてコメント取得くらいは制限しないでおいて欲しいが、制限しない理由はないよな。

コメント取得は対策しました。
[参考](https://qiita.com/tor4kichi/items/74939b49954d3e72d789)。
JSONで取得はプレイヤー側の対応が必要で面倒なので、データ取得だけ動画情報ページから取得するようにしました。
この応用で動画取得もできないかな？
暗号化されてる動画は多分無理だけど。
